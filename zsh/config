# local Variables
LOCAL_SHARE=$HOME/.local/share
LOCAL_BIN=$HOME/.local/bin

# Autosuggest strategy
ZSH_AUTOSUGGEST_STRATEGY=history
ZSH_AUTOSUGGEST_USE_ASYNC='parallel'

# History options
unsetopt inc_append_history
# Local bin to PATH
LOCAL_BIN=$HOME/.local/bin
[[ -d $LOCAL_BIN ]] && path+=$LOCAL_BIN

# Export Modulepath variable
HOME_MODULEPATH=$DOTFILES/Modules/modulefiles
[[ -d $HOME_MODULEPATH && ! $MODULEPATH =~ $HOME_MODULEPATH ]] && export MODULEPATH=$MODULEPATH:$HOME_MODULEPATH

# Load custom functions and aliases
CONFIGDIR=$CONFIG/config.d
for FILE in $(ls $CONFIGDIR)
do
    source $CONFIGDIR/$FILE
done

# Activate nord dir colors
DIRCOLORS=$LOCAL_SHARE/nord_dir_colors/src/dir_colors
test -r "$DIRCOLORS" && eval $(dircolors $DIRCOLORS)

# Setting fd as the default source for fzf
export FZF_DEFAULT_COMMAND='fd'
# To apply the command to CTRL-T as well
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"

# Edit line in vim with ctrl-e:
autoload edit-command-line; zle -N edit-command-line; bindkey '^e' edit-command-line

# ssh
[[ -f $HOME/.ssh/rsa_id ]] && export SSH_KEY_PATH="$HOME/.ssh/rsa_id"

# Disable CTRL-s in the terminal
# check xon/xoff settings
if [ -t 0 ]; then # term test?
    # Turn off TTY "start" and "stop" commands in all interactive shells.
    # They default to C-q and C-s, Bash uses C-s to do a forward history search.
    stty start ''
    stty stop  ''
    stty -ixon # disable XON/XOFF flow control
    stty ixoff # enable sending (to app) of start/stop characters
    stty ixany # let any character restart output, not only start character
fi

# Unset local variables
typeset -U path manpath

unset LOCAL_BIN LOCAL_SHARE CONFIGDIR DIRCOLORS HOME_MODULEPATH
